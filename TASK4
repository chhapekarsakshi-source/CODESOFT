import streamlit as st
import random

st.set_page_config(page_title="Rock Paper Scissors", layout="centered")

st.title("Rock Paper Scissors")

if "user_score" not in st.session_state:
    st.session_state.user_score = 0
if "computer_score" not in st.session_state:
    st.session_state.computer_score = 0
if "target_score" not in st.session_state:
    st.session_state.target_score = 0
if "game_started" not in st.session_state:
    st.session_state.game_started = False
if "game_over" not in st.session_state:
    st.session_state.game_over = False
if "message" not in st.session_state:
    st.session_state.message = ""

st.subheader("Match Settings")

target = st.number_input(
    "Play till how many points?",
    min_value=1,
    max_value=10,
    value=3
)

if st.button("Start Match"):
    st.session_state.user_score = 0
    st.session_state.computer_score = 0
    st.session_state.target_score = target
    st.session_state.game_started = True
    st.session_state.game_over = False
    st.session_state.message = "Match started!"

st.write(st.session_state.message)

if st.session_state.game_started and not st.session_state.game_over:
    st.subheader("ğŸ® Play Round")

    user_choice = st.selectbox(
        "Choose your move",
        ["Rock", "Paper", "Scissors"]
    )

    if st.button("Play Round"):
        computer_choice = random.choice(["Rock", "Paper", "Scissors"])

        st.write("You chose:", user_choice)
        st.write("Computer chose:", computer_choice)

        if user_choice == computer_choice:
            st.info("It's a Tie!")
        elif (
            (user_choice == "Rock" and computer_choice == "Scissors") or
            (user_choice == "Scissors" and computer_choice == "Paper") or
            (user_choice == "Paper" and computer_choice == "Rock")
        ):
            st.session_state.user_score += 1
            st.success("You win this round!")
        else:
            st.session_state.computer_score += 1
            st.error("Computer wins this round!")

        if st.session_state.user_score >= st.session_state.target_score:
            st.session_state.game_over = True
            st.balloons()
            st.success("You won the match!")
        elif st.session_state.computer_score >= st.session_state.target_score:
            st.session_state.game_over = True
            st.error("Computer won the match!")

if st.session_state.game_started:
    st.subheader("Scoreboard")
    st.write(f"You: {st.session_state.user_score}")
    st.write(f"Computer: {st.session_state.computer_score}")
    st.write(f"Target: {st.session_state.target_score}")

if st.session_state.game_over:
    if st.button("ğŸ” Play New Match"):
        st.session_state.game_started = False
        st.session_state.game_over = False
        st.session_state.message = ""
